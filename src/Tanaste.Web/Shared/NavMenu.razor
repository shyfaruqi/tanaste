@namespace Tanaste.Web.Shared
@inject AutomotiveModeService AutomotiveMode
@implements IDisposable

<div class="d-flex justify-center pa-3 pt-4">
    <img src="images/tanaste-icon.svg" alt="Tanaste" style="height: 44px; width: 44px;" />
</div>

<MudNavMenu>
    <MudText Typo="Typo.overline" Class="px-4 mt-2 mb-2 mud-text-disabled">Navigation</MudText>

    <MudNavLink Href="/"
                Icon="@Icons.Material.Filled.LibraryBooks"
                Match="NavLinkMatch.All">
        Library
    </MudNavLink>

    <MudDivider Class="my-2" />

    <MudText Typo="Typo.overline" Class="px-4 mt-4 mb-2 mud-text-disabled">Tools</MudText>

    <MudNavLink Href="/ingestion"
                Icon="@Icons.Material.Filled.FolderOpen">
        Ingestion
    </MudNavLink>

    <MudNavLink Href="/metadata"
                Icon="@Icons.Material.Filled.Tune">
        Metadata
    </MudNavLink>

    <MudNavLink Href="/settings"
                Icon="@Icons.Material.Filled.Settings">
        Settings
    </MudNavLink>

    <MudDivider Class="my-2" />

    <MudText Typo="Typo.overline" Class="px-4 mt-4 mb-2 mud-text-disabled">Display</MudText>

    <div class="px-2">
        <MudTooltip Text="@(AutomotiveMode.IsActive ? "Exit Automotive Mode" : "Automotive Mode â€” large touch targets, audio-only")"
                    Arrow="true" Placement="Placement.Right">
            <MudButton FullWidth="true"
                       Variant="@(AutomotiveMode.IsActive ? Variant.Filled : Variant.Outlined)"
                       Color="@(AutomotiveMode.IsActive ? Color.Error : Color.Default)"
                       StartIcon="@Icons.Material.Filled.DirectionsCar"
                       OnClick="@ToggleAutomotive"
                       Class="mb-2"
                       Style="text-transform: none; justify-content: flex-start;">
                @(AutomotiveMode.IsActive ? "Exit Automotive" : "Automotive Mode")
            </MudButton>
        </MudTooltip>
    </div>
</MudNavMenu>

@code {
    protected override void OnInitialized() =>
        AutomotiveMode.OnChanged += OnAutomotiveChanged;

    private void ToggleAutomotive() => AutomotiveMode.Toggle();

    private void OnAutomotiveChanged() => InvokeAsync(StateHasChanged);

    public void Dispose() =>
        AutomotiveMode.OnChanged -= OnAutomotiveChanged;
}
